(function(){"use strict";var e={5839:function(e,t,i){var l=i(9242),n=i(3396);function a(e,t){const i=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(i)}var s=i(89);const o={},r=(0,s.Z)(o,[["render",a]]);var d=r,h=i(2350),c=i(5431);(0,c.z)("/COVID-Risk-Region/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(e){console.log("Service worker has been registered and now polling for updates."),setInterval((()=>{e.update()}),5e3)},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(e){console.log("New content is available; please refresh."),document.dispatchEvent(new CustomEvent("swUpdated",{detail:e}))},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var _=i(179),u=i(678),p=(i(9060),i(9200),i(7086),i(6570),i(9740)),m=(i(3189),i(5065));const g=e=>((0,n.dD)("data-v-5493e71b"),e=e(),(0,n.Cn)(),e),f={class:"footer-section"},w=(0,n.Uk)(" 其余未列出地区为常态化防控区域 "),y=g((()=>(0,n._)("br",null,null,-1))),k=(0,n.Uk)(" 数据来自"),b=(0,n.Uk)("国家卫健委"),v=(0,n.Uk)(" | "),x=(0,n.Uk)("GitHub"),I=(0,n.Uk)(" | "),C=(0,n.Uk)("Api GitHub");function D(e,t,i,l,a,s){const o=m.E2;return(0,n.wg)(),(0,n.iD)("div",f,[w,y,k,(0,n.Wm)(o,{class:"link",href:"http://bmfw.www.gov.cn/yqfxdjcx/risk.html",target:"_blank"},{default:(0,n.w5)((()=>[b])),_:1}),v,(0,n.Wm)(o,{class:"link",href:"https://github.com/panghaibin/COVID-Risk-Region",target:"_blank"},{default:(0,n.w5)((()=>[x])),_:1}),I,(0,n.Wm)(o,{class:"link",href:"https://github.com/panghaibin/RiskLevelAPI",target:"_blank"},{default:(0,n.w5)((()=>[C])),_:1})])}var S={name:"FooterShow"};const W=(0,s.Z)(S,[["render",D],["__scopeId","data-v-5493e71b"]]);var O=W,$=(i(9406),i(8009),i(7655),i(8157),i(33),i(6226),i(1430),i(172),i(1844),i(6809),i(7176),i(9007),i(8474),i(9834),i(7488)),U=i(877),j=i(9566),N=i(292),z=i(8658),T=i(1902),A=i(8932),q=i(7588),E=i(6605),L=i(4351),R=i(1015),V=i(7380),J=i(7139);const M=e=>((0,n.dD)("data-v-1acf7128"),e=e(),(0,n.Cn)(),e),H={key:0},P={style:{margin:"10px auto"}},F={key:0},Z={key:1,style:{"user-select":"none"}},G={style:{display:"block","text-align":"center"}},Y=(0,n.Uk)("获取于 "),K=M((()=>(0,n._)("br",null,null,-1))),B=M((()=>(0,n._)("span",{style:{"vertical-align":"middle","padding-left":"3px"}},[(0,n._)("svg",{width:"12px",height:"12px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-info-circle"},[(0,n._)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,n._)("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"})])],-1))),Q={key:1},X={key:2,class:"history-icon"},ee=M((()=>(0,n._)("span",{class:"history-text"},"查看历史",-1))),te={key:1},ie=M((()=>(0,n._)("p",null,"加载历史记录失败！请刷新重试",-1))),le={style:{"text-align":"center"}},ne=(0,n.Uk)(" GitHub 源 "),ae=M((()=>(0,n._)("br",null,null,-1))),se=M((()=>(0,n._)("br",null,null,-1))),oe={key:1},re=M((()=>(0,n._)("br",null,null,-1))),de=M((()=>(0,n._)("span",{class:"link"},"数据来自",-1))),he=(0,n.Uk)(" 国家卫健委 "),ce=M((()=>(0,n._)("br",null,null,-1))),_e=(0,n.Uk)(" 前端项目 GitHub "),ue=M((()=>(0,n._)("br",null,null,-1))),pe=(0,n.Uk)(" Api项目 GitHub "),me=M((()=>(0,n._)("br",null,null,-1))),ge=(0,n.Uk)(" 下载全部 "),fe=(0,n.Uk)("关闭"),we={key:0,class:"history-icon",style:{float:"left"}},ye=M((()=>(0,n._)("span",{class:"history-text"},"< 上一历史数据",-1))),ke={key:1,class:"history-icon"},be=M((()=>(0,n._)("span",{class:"history-text"},"下一历史数据 >",-1))),ve={key:1,class:"filter-tree"},xe={class:"risk-show"},Ie={key:0,style:{"text-align":"center",color:"var(--el-color-info-dark-2)","font-size":"var(--el-font-size-small)"}},Ce=(0,n.Uk)(" It's Over : )"),De=M((()=>(0,n._)("br",null,null,-1))),Se=(0,n.Uk)(" 点击 查看历史 可浏览及下载过往数据"),We=M((()=>(0,n._)("br",null,null,-1))),Oe=[Ce,De,Se,We],$e={class:"high-risk-tab-label"},Ue=(0,n.Uk)("高风险 "),je={key:0,class:"num"},Ne={key:1,class:"num"},ze={class:"middle-risk-tab-label"},Te=(0,n.Uk)("中风险 "),Ae={key:0,class:"num"},qe={key:1,class:"num"},Ee={class:"low-risk-tab-label"},Le=(0,n.Uk)("低风险 "),Re={key:0,class:"num"},Ve={key:1,class:"num"},Je={key:1,id:"high-risk"},Me={class:"high-risk",style:{"margin-top":"0"}},He=(0,n.Uk)(" 高风险等级地区 "),Pe={key:0,class:"num"},Fe={key:1,class:"num"},Ze={key:2,id:"middle-risk"},Ge={class:"middle-risk"},Ye=(0,n.Uk)(" 中风险等级地区 "),Ke={key:0,class:"num"},Be={key:1,class:"num"},Qe={key:3,id:"low-risk"},Xe={class:"low-risk"},et=(0,n.Uk)(" 低风险等级地区 "),tt={key:0,class:"num"},it={key:1,class:"num"},lt={class:"back-top"},nt={key:1},at=M((()=>(0,n._)("p",null,"API 获取出错，请刷新重试",-1)));function st(e,t,i,a,s,o){const r=V.Q0,d=(0,n.up)("loading"),h=R.gn,c=(0,n.up)("clock"),_=m.E2,u=L.$Y,p=L.eI,g=(0,n.up)("Download"),f=E.mi,w=(0,n.up)("Link"),y=q.d0,k=A.EZ,b=T.Ks,v=z.p8,x=z.Ub,I=N.zi,C=j.y,D=U.vk,S=(0,n.up)("Top"),W=$.mR;return s.err?((0,n.wg)(),(0,n.iD)("div",nt,[at,(0,n._)("p",null,(0,J.zw)(s.err_msg),1)])):((0,n.wg)(),(0,n.iD)("div",H,[(0,n._)("p",P,[s.ok?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[i.type_latest?((0,n.wg)(),(0,n.iD)("span",F," 以下数据截至 "+(0,J.zw)(s.raw.data.end_update_time),1)):((0,n.wg)(),(0,n.iD)("span",Z,[(0,n.Uk)(" 历史数据 "+(0,J.zw)(s.raw.data.end_update_time)+" ",1),(0,n.Wm)(r,{class:"box-item",effect:s.dark_mode?"dark":"light",placement:"right-end"},{content:(0,n.w5)((()=>[(0,n._)("span",G,[Y,K,(0,n.Uk)(" "+(0,J.zw)(s.history.save_time),1)])])),default:(0,n.w5)((()=>[B])),_:1},8,["effect"])]))],64)):((0,n.wg)(),(0,n.iD)("span",Q,"加载中……")),(0,n.wy)((0,n._)("span",null,[(0,n.Wm)(h,{class:"is-loading"},{default:(0,n.w5)((()=>[(0,n.Wm)(d)])),_:1})],512),[[l.F8,s.loading_icon]]),s.ok&&!s.loading_icon?((0,n.wg)(),(0,n.iD)("span",X,[(0,n.Wm)(_,{underline:!1,type:"primary",onClick:o.fetch_info},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c)])),_:1}),ee])),_:1},8,["onClick"])])):(0,n.kq)("",!0)]),(0,n.Wm)(y,{modelValue:s.info.visible,"onUpdate:modelValue":t[4]||(t[4]=e=>s.info.visible=e),title:"历史数据",width:"320px"},{footer:(0,n.w5)((()=>[s.info.err?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(f,{key:0,onClick:t[2]||(t[2]=e=>s.info.download_visible=!0),style:{"margin-right":"115px"}},{default:(0,n.w5)((()=>[ge])),_:1})),(0,n.Wm)(f,{onClick:t[3]||(t[3]=e=>s.info.visible=!1),type:"primary"},{default:(0,n.w5)((()=>[fe])),_:1})])),default:(0,n.w5)((()=>[s.info.err?((0,n.wg)(),(0,n.iD)("div",te,[ie,(0,n._)("p",null,(0,J.zw)(s.info.err_msg),1)])):((0,n.wg)(),(0,n.j4)(p,{key:0,data:s.info.table,ref:"info_table","row-key":"id",onCellClick:o.info_click,"empty-text":"数据加载中……",height:"50vh"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{label:"时间"},{default:(0,n.w5)((e=>[(0,n.Uk)((0,J.zw)(e.row.update_time),1)])),_:1})])),_:1},8,["data","onCellClick"])),(0,n.Wm)(y,{modelValue:s.info.download_visible,"onUpdate:modelValue":t[1]||(t[1]=e=>s.info.download_visible=e),width:"300px",top:"25vh",title:"下载全部数据","append-to-body":""},{default:(0,n.w5)((()=>[(0,n._)("div",le,[(0,n.Wm)(f,{type:"primary",onClick:t[0]||(t[0]=e=>o.download_data(-1)),style:{width:"10em"},plain:s.dark_mode},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g)])),_:1}),ne])),_:1},8,["plain"]),ae,se,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.gh_proxy_list,((e,t)=>((0,n.wg)(),(0,n.iD)(n.HY,{key:t},[t<3?((0,n.wg)(),(0,n.j4)(_,{key:0,type:"default",underline:!1,onClick:e=>o.download_data(t),class:"proxy-download-link"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g)])),_:1}),(0,n.Uk)(" 镜像源 "+(0,J.zw)(t+1),1)])),_:2},1032,["onClick"])):(0,n.kq)("",!0),(t+1)%3===0&&t<3?((0,n.wg)(),(0,n.iD)("br",oe)):(0,n.kq)("",!0)],64)))),128)),re,de,(0,n.Wm)(_,{class:"link",href:"http://bmfw.www.gov.cn/yqfxdjcx/risk.html",target:"_blank"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w)])),_:1}),he])),_:1}),ce,(0,n.Wm)(_,{class:"link",href:"https://github.com/panghaibin/COVID-Risk-Region",target:"_blank"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w)])),_:1}),_e])),_:1}),ue,(0,n.Wm)(_,{class:"link",href:"https://github.com/panghaibin/RiskLevelAPI",target:"_blank"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w)])),_:1}),pe])),_:1}),me])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),i.type_latest?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,J.C_)(s.ok?["history-pre-next"]:["history-pre-next","item-disabled"])},[s.history.pre?((0,n.wg)(),(0,n.iD)("span",we,[(0,n.Wm)(_,{underline:!1,type:"primary",onClick:t[5]||(t[5]=e=>o.router_to(s.history.pre))},{default:(0,n.w5)((()=>[ye])),_:1})])):(0,n.kq)("",!0),s.history.next?((0,n.wg)(),(0,n.iD)("span",ke,[(0,n.Wm)(_,{underline:!1,type:"primary",onClick:t[6]||(t[6]=e=>o.router_to(s.history.next))},{default:(0,n.w5)((()=>[be])),_:1})])):(0,n.kq)("",!0)],2)),s.high.display||s.middle.display||s.low.display?((0,n.wg)(),(0,n.iD)("div",ve,[(0,n.Wm)(k,{disabled:!s.ok,ref:"filter_input",modelValue:s.filter_text,"onUpdate:modelValue":t[7]||(t[7]=e=>s.filter_text=e),placeholder:"请输入区域名称，多个关键词空格分隔",clearable:"",onClear:t[8]||(t[8]=t=>o.tag_add(e.$refs.filter_input.input.value)),onChange:o.tag_add},null,8,["disabled","modelValue","onChange"]),(0,n._)("template",{class:(0,J.C_)(s.ok?["tag-list"]:["tag-list","item-disabled"])},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.filter_history,((e,t)=>((0,n.wg)(),(0,n.j4)(b,{type:s.dark_mode?"info":"",key:t,closable:!0,onClose:e=>o.tag_remove(t),onClick:t=>{s.filter_text=e,o.tag_add(e)},class:"tag-item"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,J.zw)(e),1)])),_:2},1032,["type","onClose","onClick"])))),128))],2)])):(0,n.kq)("",!0),(0,n._)("div",xe,[s.high.display||s.middle.display||s.low.display?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",Ie,Oe)),(0,n.Wm)(I,{target:".risk-show"},{default:(0,n.w5)((()=>[(0,n.Wm)(x,{onTabClick:o.handle_tabs_click,modelValue:s.selected_tab,"onUpdate:modelValue":t[9]||(t[9]=e=>s.selected_tab=e),class:(0,J.C_)(s.ok?["risk-tab-label"]:["risk-tab-label","item-disabled"]),stretch:""},{default:(0,n.w5)((()=>[s.high.display?((0,n.wg)(),(0,n.j4)(v,{key:0,name:"#high-risk"},{label:(0,n.w5)((()=>[(0,n._)("span",$e,[Ue,s.ok?((0,n.wg)(),(0,n.iD)("span",je,"("+(0,J.zw)(s.high.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",Ne,"(-)"))])])),_:1})):(0,n.kq)("",!0),s.middle.display?((0,n.wg)(),(0,n.j4)(v,{key:1,name:"#middle-risk"},{label:(0,n.w5)((()=>[(0,n._)("span",ze,[Te,s.ok?((0,n.wg)(),(0,n.iD)("span",Ae,"("+(0,J.zw)(s.middle.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",qe,"(-)"))])])),_:1})):(0,n.kq)("",!0),s.low.display?((0,n.wg)(),(0,n.j4)(v,{key:2,name:"#low-risk"},{label:(0,n.w5)((()=>[(0,n._)("span",Ee,[Le,s.ok?((0,n.wg)(),(0,n.iD)("span",Re,"("+(0,J.zw)(s.low.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",Ve,"(-)"))])])),_:1})):(0,n.kq)("",!0)])),_:1},8,["onTabClick","modelValue","class"])])),_:1}),s.high.display?((0,n.wg)(),(0,n.iD)("div",Je,[(0,n._)("h3",Me,[He,s.ok?((0,n.wg)(),(0,n.iD)("span",Pe,"("+(0,J.zw)(s.high.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",Fe,"(-)")),(0,n.Wm)(f,{class:"expand-all",type:s.dark_mode?"info":"primary",onClick:o.high_expand,disabled:!s.ok},{default:(0,n.w5)((()=>[(0,n.Uk)((0,J.zw)(s.high.expand_all_button),1)])),_:1},8,["type","onClick","disabled"])]),s.ok?((0,n.wg)(),(0,n.j4)(C,{key:s.high.key,data:s.high.tree,props:s.tree_props,"node-key":"id","default-expand-all":s.high.expand_all,"default-expanded-keys":s.high.default_id_list,"auto-expand-parent":!1,ref:"high_tree","filter-node-method":o.high_filter,"render-content":o.render_tree,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method","render-content"])):((0,n.wg)(),(0,n.j4)(D,{key:1,rows:2,animated:""}))])):(0,n.kq)("",!0),s.middle.display?((0,n.wg)(),(0,n.iD)("div",Ze,[(0,n._)("h3",Ge,[Ye,s.ok?((0,n.wg)(),(0,n.iD)("span",Ke,"("+(0,J.zw)(s.middle.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",Be,"(-)")),(0,n.Wm)(f,{class:"expand-all",type:s.dark_mode?"info":"primary",onClick:o.middle_expand,disabled:!s.ok},{default:(0,n.w5)((()=>[(0,n.Uk)((0,J.zw)(s.middle.expand_all_button),1)])),_:1},8,["type","onClick","disabled"])]),s.ok?((0,n.wg)(),(0,n.j4)(C,{key:s.middle.key,data:s.middle.tree,props:s.tree_props,"node-key":"id","default-expand-all":s.middle.expand_all,"default-expanded-keys":s.middle.default_id_list,"auto-expand-parent":!1,ref:"middle_tree","filter-node-method":o.middle_filter,"render-content":o.render_tree,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method","render-content"])):((0,n.wg)(),(0,n.j4)(D,{key:1,rows:2,animated:""}))])):(0,n.kq)("",!0),s.low.display?((0,n.wg)(),(0,n.iD)("div",Qe,[(0,n._)("h3",Xe,[et,s.ok?((0,n.wg)(),(0,n.iD)("span",tt,"("+(0,J.zw)(s.low.count)+")",1)):((0,n.wg)(),(0,n.iD)("span",it,"(-)")),(0,n.Wm)(f,{class:"expand-all",type:s.dark_mode?"info":"primary",onClick:o.low_expand,disabled:!s.ok},{default:(0,n.w5)((()=>[(0,n.Uk)((0,J.zw)(s.low.expand_all_button),1)])),_:1},8,["type","onClick","disabled"])]),s.ok?((0,n.wg)(),(0,n.j4)(C,{key:s.low.key,data:s.low.tree,props:s.tree_props,"node-key":"id","default-expand-all":s.low.expand_all,"default-expanded-keys":s.low.default_id_list,"auto-expand-parent":!1,ref:"low_tree","filter-node-method":o.low_filter,"render-content":o.render_tree,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method","render-content"])):((0,n.wg)(),(0,n.j4)(D,{key:1,rows:2,animated:""}))])):(0,n.kq)("",!0)]),(0,n.Wm)(W,{onClick:o.back_to_top},{default:(0,n.w5)((()=>[(0,n._)("div",lt,[(0,n.Wm)(S,{style:{width:"1em",height:"1em",margin:"0.5em"}})])])),_:1},8,["onClick"])]))}var ot=i(6265),rt=i.n(ot),dt=i(6666),ht=(i(8742),i(354)),ct=i.n(ht),_t=i(7165),ut=i.n(_t),pt={name:"RegionShow",props:{data_url:String,info_url:String,type_latest:Boolean},computed:{data_name(){return this.data_url.split("/").pop().split(".").shift()},data_name_timestamp(){return this.data_name+"_timestamp"}},data(){return{api_url_list:JSON.parse(localStorage.getItem("api_url_list")||"[]"),api_url:localStorage.getItem("api_url")||"",gh_proxy_list:JSON.parse(localStorage.getItem("gh_proxy_list")||"[]"),selected_tab:"",is_scrolling:!1,section_observer:null,section_selector:["#high-risk","#middle-risk","#low-risk",".filter-tree",".header"],raw:null,ok:!1,err:!1,err_msg:"",info:{raw:null,visible:!1,download_visible:!1,ok:!1,err:!1,err_msg:"",table:null},history:{pre:null,next:null,save_time:null},high:{key:0,display:!0,tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},middle:{key:0,display:!1,tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},low:{key:0,display:!0,tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},tree_props:{label:"label",children:"children",class:"tree-node"},filter_text:"",filter_history:JSON.parse(localStorage.getItem("filter_history")||'["北京市", "上海市", "江苏省"]'),dark_mode:!1,loading_icon:!1}},async mounted(){let e=this;this.api_url||(this.api_url=this.api_url_list[0],localStorage.setItem("api_url",this.api_url)),this.type_latest?await ut().getItem(this.data_name_timestamp)&&await ut().getItem(this.data_name)?await this.fetch_latest(!0):await this.fetch_latest(!1):(await this.fetch_history(),this.fetch_data(this.info_url,null,!0).then((t=>{e.info.raw=t;const i=this.$route.params.fileName,l=this.get_current_history_info(i);this.history.pre=l.pre,this.history.next=l.next,this.history.save_time=l.save_time})));let t=window.matchMedia("(prefers-color-scheme: dark)");t.addEventListener("change",this.handle_color_scheme_change),this.handle_color_scheme_change(t);let i=setInterval((()=>{this.loading_icon||(this.observe_sections(),clearInterval(i))}),100);if(this.$route.hash&&-1!==this.section_selector.indexOf(this.$route.hash)){setTimeout((()=>{window.scrollTo(0,0)}),100);let e=setInterval((()=>{this.loading_icon||(this.scroll_to(this.$route.hash),this.selected_tab=`#${this.$route.hash}`,clearInterval(e))}),100)}},methods:{async fetch_data(e,t=null,i=!1,l=!1,n=0){let a=e.split(".").shift(),s=a+"_timestamp",o=await ut().getItem(a);if(i&&o)return o;if(!l&&(new Date).getTime()-await ut().getItem(s)<3e5)return o;let r=this.api_url;null!==t&&((t<0||t>=this.api_url_list.length)&&(t=0),r=this.api_url_list[t],localStorage.setItem("api_url",r));let d=r+e,h=3e3,c=rt().CancelToken;const _=c.source(),u=setTimeout((()=>{_.cancel()}),h);let p=this;try{let e=await rt().get(d,{cancelToken:_.token});clearTimeout(u);let t=e.data;try{await ut().setItem(a,t),await ut().setItem(s,(new Date).getTime())}catch(m){console.log(m),ut().keys().then((e=>{e.forEach((e=>{-1===e.indexOf("api")&&-1===e.indexOf("latest")&&-1===e.indexOf("info")&&ut().removeItem(e)}))}))}return Promise.resolve(t)}catch(g){clearTimeout(u),console.log(d,g),console.log(g.response),null===t&&(t=p.api_url_list.indexOf(r)),t++,n++;const a=p.api_url_list.length<10?p.api_url_list.length:10;return g.response&&404===g.response.status&&n>5||n>a?Promise.reject(g):p.fetch_data(e,t,i,l,n)}},async fetch_latest(e=!1){if(e){if(this.raw=await ut().getItem(this.data_name),this.high_init().then(),this.middle_init().then(),this.low_init().then(),this.ok=!0,(new Date).getTime()-await ut().getItem(this.data_name_timestamp)<3e5)return;this.loading_icon=!0}else this.loading_icon=!0;let t=this.data_url+"?t="+(new Date).getTime();this.fetch_data(t,null,!1,!0).then((async e=>{let t,i=!0;this.ok?this.raw.data["end_update_time"]!==e["data"]["end_update_time"]?t="数据更新成功":(t="已是最新数据",i=!1):t="数据加载成功",dt.bM.success({message:t,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item"}),i&&(this.raw=e,this.high_init().then(),this.middle_init().then(),this.low_init().then(),this.ok=!0),this.loading_icon=!1})).catch((e=>{if(console.log(e),this.ok){let e="数据更新失败<br>已显示缓存数据";dt.bM.info({message:e,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item",dangerouslyUseHTMLString:!0})}else this.err_msg=e,this.err=!0;this.loading_icon=!1}))},fetch_info(){this.info.visible=!0,this.info.err=!1;let e=this;this.fetch_data(this.info_url).then((t=>{e.info.raw=t;let i=t["file_list"],l=[],n=0;for(let e=i.length-1;e>=0;e--){let t=i[e],a=t["file_name"].replace(".json",""),s=new Date(1e3*t["update_time"]),o=s.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit"}),r=s.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",hour12:!1,hour:"2-digit"});o=o.replace(/\//g,"-"),r=r.replace("24","00"),l.length&&l[l.length-1]["update_time"]===o?l[l.length-1]["children"].unshift({id:n++,update_time:o+" "+r,file_name:a}):l.push({id:n++,update_time:o,file_name:"#",children:[{id:n++,update_time:o+" "+r,file_name:a}]})}e.info.table=l,e.info.ok=!0})).catch((t=>{e.info.err=!0,e.info.err_msg=t,console.log(t)}))},async fetch_history(){this.loading_icon=!0;let e=this.data_url;this.fetch_data(e,null,!0).then((async e=>{this.raw=e,this.high_init().then(),this.middle_init().then(),this.low_init().then(),this.ok=!0,this.loading_icon=!1,setTimeout((()=>{this.filter_text=localStorage.getItem("filter_text")||"",localStorage.setItem("filter_text","")}),0),ut().setItem(`${this.data_name}_timestamp`,(new Date).getTime()).then()})).catch((e=>{console.log(e);let t="历史数据加载失败";dt.bM.info({message:t,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item"}),this.err_msg=e,this.err=!0,this.loading_icon=!1}))},list2tree(e,t){let i=[],l=0,n=[],a=[],s=[];for(let o=0;o<e.length;o++){let t=e[o],r=t["province"],d=t["city"],h=t["county"],c=t["communitys"],_=null,u=null,p=null,m=null;for(let e=0;e<i.length;e++){let t=i[e];if(t.label===r){_=t;break}}null===_&&(_={id:l++,count:0,pid:-1,label:r,children:[],expanded:!0},i.push(_),n.push(_.id));for(let e=0;e<_.children.length;e++){let t=_.children[e];if(t.label===d){u=t;break}}null===u&&(u={id:l++,count:0,pid:_.id,label:d,children:[],expanded:!0},_.children.push(u),a.push(u.id));for(let e=0;e<u.children.length;e++){let t=u.children[e];if(t.label===h){p=t;break}}null===p&&(p={id:l++,count:0,pid:u.id,label:h,children:[],expanded:!0},u.children.push(p),s.push(p.id));for(let e=0;e<p.children.length;e++){let t=p.children[e];if(t.label===c){m=t;break}}if(null===m){m=[];for(let e=0;e<c.length;e++)_.count++,u.count++,p.count++,p.children.push({id:l++,pid:p.id,label:c[e]})}}t.display=!!i.length,t.tree=i,t.province_id_list=n,t.city_id_list=a,t.county_id_list=s,t.default_id_list=a.length<15?n:null},async high_init(e=null){if(this.raw.data["hcount"]){if(e){const t=await ut().getItem(`${e}_high`);!t||(new Date).getTime()-await ut().getItem(`${e}_timestamp`)>3e5?(this.list2tree(this.raw.data["highlist"],this.high),this.high.count=this.raw.data["hcount"],ut().setItem(`${e}_high`,JSON.parse(JSON.stringify(this.high))).then()):this.high=t}else this.list2tree(this.raw.data["highlist"],this.high),this.high.count=this.raw.data["hcount"];this.high.key++}else this.high.display=!1},async middle_init(e=null){if(this.raw.data["mcount"]){if(e){const t=await ut().getItem(`${e}_middle`);!t||(new Date).getTime()-await ut().getItem(`${e}_timestamp`)>3e5?(this.list2tree(this.raw.data["middlelist"],this.middle),this.middle.count=this.raw.data["mcount"],ut().setItem(`${e}_middle`,JSON.parse(JSON.stringify(this.middle))).then()):this.middle=t}else this.list2tree(this.raw.data["middlelist"],this.middle),this.middle.count=this.raw.data["mcount"];this.middle.key++}else this.middle.display=!1},async low_init(e=null){if(this.raw.data["lcount"]){if(e){const t=await ut().getItem(`${e}_low`);!t||(new Date).getTime()-await ut().getItem(`${e}_timestamp`)>3e5?(this.list2tree(this.raw.data["lowlist"],this.low),this.low.count=this.raw.data["lcount"],ut().setItem(`${e}_low`,JSON.parse(JSON.stringify(this.low))).then()):this.low=t}else this.list2tree(this.raw.data["lowlist"],this.low),this.low.count=this.raw.data["lcount"];this.low.display=!0,this.low.empty_text="无数据",this.low.key++}else this.low.display=!1},render_tree(e,{node:t}){return e("span",{class:"el-tree-node__label"},e("span",null,`${t.label}`),e("span",{style:"font-size: 0.87rem;"},(()=>{if(t.data.expanded)return` (${t.data.count})`})()))},high_expand(){if(this.high.expand_all=!this.high.expand_all,this.high.expand_all){let e=this.high.province_id_list.concat(this.high.city_id_list).concat(this.high.county_id_list);for(let t=0;t<e.length;t++)this.$refs.high_tree.store.getNode(e[t]).expanded=!0}else{let e=this.high.city_id_list.length<15?this.high.city_id_list:this.high.province_id_list;for(let t=0;t<e.length;t++)this.$refs.high_tree.store.getNode(e[t]).expanded=!1}this.high.expand_all_button=this.high.expand_all?"收起":"展开"},middle_expand(){if(this.middle.expand_all=!this.middle.expand_all,this.middle.expand_all){let e=this.middle.province_id_list.concat(this.middle.city_id_list).concat(this.middle.county_id_list);for(let t=0;t<e.length;t++)this.$refs.middle_tree.store.getNode(e[t]).expanded=!0}else{let e=this.middle.city_id_list.length<15?this.middle.city_id_list:this.middle.province_id_list;for(let t=0;t<e.length;t++)this.$refs.middle_tree.store.getNode(e[t]).expanded=!1}this.middle.expand_all_button=this.middle.expand_all?"收起":"展开"},low_expand(){if(this.low.expand_all=!this.low.expand_all,this.low.expand_all){let e=this.low.province_id_list.concat(this.low.city_id_list).concat(this.low.county_id_list);for(let t=0;t<e.length;t++)this.$refs.low_tree.store.getNode(e[t]).expanded=!0}else{let e=this.low.city_id_list.length<15?this.low.city_id_list:this.low.province_id_list;for(let t=0;t<e.length;t++)this.$refs.low_tree.store.getNode(e[t]).expanded=!1}this.low.expand_all_button=this.low.expand_all?"收起":"展开"},high_filter(e,t){if(!e)return void 0===t.children&&this.high.count++,!0;let i=e.split(" ");for(let l=0;l<i.length;l++){let e=i[l];if(!e)continue;if(t.label.includes(e))return void 0===t.children&&this.high.count++,!0;let n=t.pid;while(-1!==n){let i=this.$refs.high_tree.store.getNode(n).data;if(i.label.includes(e))return void 0===t.children&&this.high.count++,!0;n=i.pid}}return!1},middle_filter(e,t){if(!e)return void 0===t.children&&this.middle.count++,!0;let i=e.split(" ");for(let l=0;l<i.length;l++){let e=i[l];if(!e)continue;if(t.label.includes(e))return void 0===t.children&&this.middle.count++,!0;let n=t.pid;while(-1!==n){let i=this.$refs.middle_tree.store.getNode(n).data;if(i.label.includes(e))return void 0===t.children&&this.middle.count++,!0;n=i.pid}}return!1},low_filter(e,t){if(!e)return void 0===t.children&&this.low.count++,!0;let i=e.split(" ");for(let l=0;l<i.length;l++){let e=i[l];if(!e)continue;if(t.label.includes(e))return void 0===t.children&&this.low.count++,!0;let n=t.pid;while(-1!==n){let i=this.$refs.low_tree.store.getNode(n).data;if(i.label.includes(e))return void 0===t.children&&this.low.count++,!0;n=i.pid}}return!1},tag_add(e){if(e=e.trim(),""!==e){while(e.includes("  "))e=e.replace("  "," ");this.filter_history.unshift(e),this.filter_history=Array.from(new Set(this.filter_history)),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))}},tag_remove(e){this.filter_history.splice(e,1),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))},router_to(e){e&&this.$router.push({path:"./"+e})},info_click(e){"#"===e.file_name?this.$refs.info_table.toggleRowExpansion(e):this.router_to(e.file_name)},get_current_history_info(e){const t=this.info.raw["file_list"];let i=t.findIndex((t=>t.file_name===e+".json"));if(-1===i)return;const l=i-1,n=i+1,a=l<0?null:t[l]["file_name"].replace(".json",""),s=n>=t.length?null:t[n]["file_name"].replace(".json",""),o=new Date(1e3*t[i]["save_time"]).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}).replace(/\//g,"-");return{pre:a,next:s,save_time:o}},download_data(e){const t="https://github.com/panghaibin/RiskLevelAPI/archive/refs/heads/api.zip";-1===e?window.open(t):e>=0&&e<this.gh_proxy_list.length&&window.open(this.gh_proxy_list[e]+t)},scroll_to(e){this.$router.push({path:"",hash:e,replace:!0});const t=e?document.querySelectorAll(e)[0].offsetTop-55:0;this.is_scrolling=!0;const i=t.toFixed(),l=()=>{window.pageYOffset.toFixed()===i&&(window.removeEventListener("scroll",l),this.is_scrolling=!1)};window.addEventListener("scroll",l),l(),window.scrollTo({left:0,top:t,behavior:"smooth"})},handle_tabs_click(e){this.scroll_to(e.props.name)},back_to_top(){this.scroll_to(""),this.selected_tab=""},handle_color_scheme_change(e){this.dark_mode=e.matches},observe_sections(){try{this.section_observer.disconnect()}catch(i){}const e={rootMargin:"-15% 0px -85%",threshold:0};this.section_observer=new IntersectionObserver(ct()((e=>{this.section_observer_handler(e)}),10),e);const t=document.querySelectorAll(this.section_selector);t.forEach((e=>{this.section_observer.observe(e)}))},section_observer_handler(e){for(const t of e)if(t.isIntersecting&&!this.is_scrolling){const e=t.target.id,i=""===e?"":"#"+e;this.selected_tab=i,this.$router.push({path:"",hash:i,replace:!0})}}},watch:{filter_text(e){e=e.trim();while(e.includes("  "))e=e.replace("  "," ");this.high.display&&(this.high.count=0,this.$refs.high_tree.filter(e),e&&(this.high.expand_all=!0,this.high.expand_all_button="收起")),this.middle.display&&(this.middle.count=0,this.$refs.middle_tree.filter(e),e&&(this.middle.expand_all=!0,this.middle.expand_all_button="收起")),this.low.display&&(this.low.count=0,this.$refs.low_tree.filter(e),e&&(this.low.expand_all=!0,this.low.expand_all_button="收起"))},is_scrolling(e){e&&setTimeout((()=>{this.is_scrolling=!1}),1e3)}},beforeUnmount(){window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.handle_color_scheme_change),this.section_observer.disconnect(),this.raw=null,this.high=null,this.middle=null,this.low=null,this.filter_history=null,localStorage.setItem("filter_text",this.filter_text),this.filter_text=null}};const mt=(0,s.Z)(pt,[["render",st],["__scopeId","data-v-1acf7128"]]);var gt=mt;const ft={class:"content-body"},wt={class:"content"};function yt(e,t,i,l,a,s){const o=(0,n.up)("Head"),r=(0,n.up)("router-link"),d=p.nZ,h=gt,c=p.b2,_=O,u=p.F_,m=p.G4;return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n._)("title",null,(0,J.zw)(a.title),1)])),_:1}),(0,n._)("div",ft,[(0,n._)("div",wt,[(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"header"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{to:"/"},{default:(0,n.w5)((()=>[(0,n._)("h1",null,(0,J.zw)(a.title),1)])),_:1})])),_:1}),(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)(h,{key:s.api_url,data_url:s.api_url,info_url:a.info_url,type_latest:s.type_latest},null,8,["data_url","info_url","type_latest"]))])),_:1}),(0,n.Wm)(u,{class:"footer"},{default:(0,n.w5)((()=>[(0,n.Wm)(_)])),_:1})])),_:1})])])],64)}var kt={data(){return{refreshing:!1,registration:null,updateExists:!1}},created(){document.addEventListener("swUpdated",this.updateAvailable,{once:!0}),navigator.serviceWorker.addEventListener("controllerchange",(()=>{this.refreshing||(this.refreshing=!0,window.location.reload())}))},methods:{updateAvailable(e){this.registration=e.detail,this.updateExists=!0,this.refreshApp()},refreshApp(){this.updateExists=!1,this.registration&&this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"})}}};const bt="https://raw.githubusercontent.com/panghaibin/RiskLevelAPI/api/",vt=(()=>{const e=JSON.parse('["gh-proxy.caduo.ml", "ghproxy.com", "ghproxy.net"]').map((e=>`https://${e}/`)),t=e.slice(2,e.length);for(let i=1;i<t.length;i++){const e=Math.floor(Math.random()*(i+1));[t[i],t[e]]=[t[e],t[i]]}return e.slice(0,2).concat(t)})(),xt=[bt].concat(JSON.parse('["https://api.risk-region.ml/", "https://raw.githubusercontents.com/panghaibin/RiskLevelAPI/api/"]')).concat(vt.map((e=>`${e}${bt}`)));localStorage.setItem("api_url_list",JSON.stringify(xt)),localStorage.setItem("gh_proxy_list",JSON.stringify(vt));var It={name:"HomeView",components:{RegionShow:gt,FooterShow:O,Head:h.Fb},computed:{api_url(){let e=this.$route.params.fileName;return e?e+".json":"latest.json"},type_latest(){return!this.$route.params.fileName}},data(){return{title:"全国新冠疫情风险地区查询",info_url:"info.json"}},watch:{api_url(){window.scroll({top:0,behavior:"smooth"})}},mixins:[kt]};const Ct=(0,s.Z)(It,[["render",yt]]);var Dt=Ct;const St=[{path:"/:fileName?",name:"home",component:Dt}],Wt=(0,u.p7)({history:(0,u.PO)("/COVID-Risk-Region/"),routes:St});var Ot=Wt;const $t=(0,l.ri)(d);$t.use(Ot);for(const[jt,Nt]of Object.entries(_))$t.component(jt,Nt);const Ut=(0,h.G6)();$t.use(Ut),$t.mount("#app")}},t={};function i(l){var n=t[l];if(void 0!==n)return n.exports;var a=t[l]={exports:{}};return e[l](a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,l,n,a){if(!l){var s=1/0;for(h=0;h<e.length;h++){l=e[h][0],n=e[h][1],a=e[h][2];for(var o=!0,r=0;r<l.length;r++)(!1&a||s>=a)&&Object.keys(i.O).every((function(e){return i.O[e](l[r])}))?l.splice(r--,1):(o=!1,a<s&&(s=a));if(o){e.splice(h--,1);var d=n();void 0!==d&&(t=d)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[l,n,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var l in t)i.o(t,l)&&!i.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,a,s=l[0],o=l[1],r=l[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(r)var h=r(i)}for(t&&t(l);d<s.length;d++)a=s[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(h)},l=self["webpackChunkcovid_risk_region"]=self["webpackChunkcovid_risk_region"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=i.O(void 0,[998],(function(){return i(5839)}));l=i.O(l)})();
//# sourceMappingURL=app.3d0f0497.js.map